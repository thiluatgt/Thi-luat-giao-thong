<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Há»‡ thá»‘ng kiá»ƒm tra luáº­t giao thÃ´ng</title>
</head>

<body style="
  margin:0;
  font-family:'Segoe UI', Arial;
  min-height:100vh;
  background:
    linear-gradient(rgba(0,0,0,0.55), rgba(0,0,0,0.55)),
    url('https://images.unsplash.com/photo-1503376780353-7e6692767b70');
  background-size:cover;
  background-position:center;
  display:flex;
  align-items:center;
  justify-content:center;
">

  <!-- KHUNG ÄÄ‚NG NHáº¬P -->
  <div style="
    width:560px;
    background:#ffffff;
    border-radius:14px;
    padding:40px 45px;
    box-shadow:0 20px 50px rgba(0,0,0,0.35);
  ">

    <h2 style="
      text-align:center;
      color:#1d3557;
      line-height:1.4;
      margin-bottom:10px;
    ">
      Há»† THá»NG KIá»‚M TRA<br>
      LUáº¬T GIAO THÃ”NG ÄÆ¯á»œNG Bá»˜ TRá»°C TUYáº¾N
    </h2>

    <p style="
      text-align:center;
      color:#555;
      font-size:14px;
      margin-bottom:30px;
    ">
      Ná»n táº£ng kiá»ƒm tra & Ä‘Ã¡nh giÃ¡ kiáº¿n thá»©c luáº­t giao thÃ´ng
    </p>

    <!-- ÄÄ‚NG NHáº¬P Há»ŒC VIÃŠN -->
    <label style="font-weight:600;">MÃ£ há»c viÃªn</label>
    <input
      id="studentCode"
      type="text"
      placeholder="VÃ­ dá»¥: HV001"
      style="
        width:100%;
        padding:14px;
        margin-top:8px;
        margin-bottom:20px;
        border-radius:6px;
        border:1px solid #ccc;
        font-size:15px;
      "
    >

    <button
      onclick="loginStudent()"
      style="
        width:100%;
        padding:15px;
        background:#1d3557;
        color:#fff;
        border:none;
        border-radius:6px;
        font-size:17px;
        cursor:pointer;
      "
    >
      ğŸ” ÄÄƒng nháº­p há»‡ thá»‘ng
    </button>

    <div style="text-align:center;margin:28px 0;color:#aaa;">
      â€” hoáº·c â€”
    </div>

    <!-- KHÃCH -->
    <button
      onclick="loginGuest()"
      style="
        width:100%;
        padding:15px;
        background:#2a9d8f;
        color:#fff;
        border:none;
        border-radius:6px;
        font-size:17px;
        cursor:pointer;
      "
    >
      ğŸ¯ Kiá»ƒm tra thá»­ khÃ´ng cáº§n Ä‘Äƒng nháº­p
    </button>

    <!-- GHI CHÃš -->
    <div style="
      margin-top:28px;
      font-size:13.5px;
      color:#555;
      line-height:1.6;
      text-align:center;
    ">
      Báº¡n chÆ°a Ä‘Äƒng kÃ½ mÃ£ há»c viÃªn?  
      Báº¡n cÃ³ thá»ƒ <b>kiá»ƒm tra thá»­</b> Ä‘á»ƒ tráº£i nghiá»‡m thá»±c táº¿ há»‡ thá»‘ng.
      <br><br>
      Äá»ƒ sá»­ dá»¥ng <b>Ä‘áº§y Ä‘á»§ cÃ¡c chá»©c nÄƒng</b>,  
      vui lÃ²ng liÃªn há»‡ <b>quáº£n trá»‹ viÃªn</b>.
    </div>

  </div>

  <!-- FIREBASE -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

  <script>
    // ğŸ”´ DÃN FIREBASE CONFIG Cá»¦A Báº N VÃ€O ÄÃ‚Y
    const firebaseConfig = {
      apiKey: "AIzaSyBGivIEsyBLsLs0CqRvwmwceG26duZbWlM",
      authDomain: "thi-luat-giao-thong.firebaseapp.com",
      projectId: "thi-luat-giao-thong",
      storageBucket: "thi-luat-giao-thong.firebasestorage.app",
      messagingSenderId: "173046681456",
      appId: "1:173046681456:web:33da411c508ee243a149b5"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // ÄÄ‚NG NHáº¬P Há»ŒC VIÃŠN
    function loginStudent() {
      const input = document.getElementById("studentCode");
      const code = input.value.trim().toUpperCase();

      if (!code) {
        alert("Vui lÃ²ng nháº­p mÃ£ há»c viÃªn");
        return;
      }

      db.collection("students")
        .where("code", "==", code)
        .get()
        .then(snapshot => {
          if (snapshot.empty) {
            alert("âŒ MÃ£ há»c viÃªn khÃ´ng tá»“n táº¡i");
            return;
          }

          const student = snapshot.docs[0].data();

          if (student.status !== "Hoáº¡t Ä‘á»™ng") {
            alert("âŒ TÃ i khoáº£n Ä‘ang bá»‹ khÃ³a");
            return;
          }

          localStorage.setItem("userType", "student");
          localStorage.setItem("studentCode", student.code);
          localStorage.setItem("studentName", student.name);

          window.location.href = "exam.html";
        })
        .catch(err => {
          console.error(err);
          alert("âŒ Lá»—i káº¿t ná»‘i há»‡ thá»‘ng");
        });
    }

    // ÄÄ‚NG NHáº¬P KHÃCH
    function loginGuest() {
      localStorage.setItem("userType", "guest");
      localStorage.setItem("studentCode", "GUEST");
      localStorage.setItem("studentName", "KhÃ¡ch kiá»ƒm tra thá»­");
      window.location.href = "thi.html";
    }
  </script>

</body>
</html>
