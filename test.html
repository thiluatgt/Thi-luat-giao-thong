<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>CH·ªåN B·ªò ƒê·ªÄ KI·ªÇM TRA</title>

<style>
body{margin:0;font-family:Arial;background:#eef2f6;}
header{
 background:#1d3557;color:white;
 padding:20px;text-align:center;
 font-size:22px;font-weight:bold;
}
.container{max-width:1200px;margin:40px auto;padding:0 20px;}
.grid{
 display:grid;
 grid-template-columns:repeat(auto-fit,minmax(260px,1fr));
 gap:20px;
}
.card{
 background:white;padding:20px;border-radius:14px;
 box-shadow:0 4px 15px rgba(0,0,0,.12);
 cursor:pointer;transition:.2s;
}
.card:hover{
 transform:translateY(-4px);
 box-shadow:0 6px 20px rgba(0,0,0,.18);
}
.card h3{margin-top:0;color:#1d3557;}
.card p{margin:6px 0;color:#555;}

#detailBox{
 display:none;background:white;border-radius:14px;
 padding:25px;box-shadow:0 6px 20px rgba(0,0,0,.18);
 max-width:720px;margin:40px auto;
}
.actions{
 margin-top:25px;display:flex;
 gap:15px;justify-content:center;
}
.btn{
 border:none;border-radius:10px;
 padding:14px 22px;font-size:16px;
 cursor:pointer;min-width:220px;color:white;
}
.btnStart{background:#2a9d8f;}
.btnBack{background:#457b9d;}
</style>
</head>

<body>

<header>H·ªÜ TH·ªêNG KI·ªÇM TRA LU·∫¨T GIAO TH√îNG</header>

<div class="container" id="listBox">
 <h2 style="color:#1d3557">üöõ Ki·ªÉm tra l√°i xe √¥ t√¥ qu√¢n s·ª±</h2>
 <div class="grid" id="setList"></div>
</div>

<div id="detailBox">
 <h2 id="dName"></h2>
 <p><b>M√£ b·ªô ƒë·ªÅ:</b> <span id="dCode"></span></p>
 <p><b>M√¥ t·∫£:</b> <span id="dDesc"></span></p>

 <div class="actions">
  <button class="btn btnStart" onclick="startExam()">‚ñ∂ B·∫Øt ƒë·∫ßu l√†m b√†i</button>
  <button class="btn btnBack" onclick="back()">‚Ü© Quay l·∫°i</button>
 </div>
</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
firebase.initializeApp({
 apiKey:"AIzaSyBGivIEsyBLsLs0CqRvwmwceG26duZbWlM",
 authDomain:"thi-luat-giao-thong.firebaseapp.com",
 projectId:"thi-luat-giao-thong"
});
const db=firebase.firestore();

let currentSet=null;

/* ===== LOAD QUESTION SETS ===== */
db.collection("question_sets")
 .where("active","==",true)
 .get()
 .then(snap=>{
  if(snap.empty){
   setList.innerHTML="<p>Ch∆∞a c√≥ b·ªô ƒë·ªÅ n√†o</p>";
   return;
  }
  snap.forEach(doc=>{
   const d=doc.data();
   setList.insertAdjacentHTML("beforeend",`
    <div class="card" onclick="showDetail('${doc.id}')">
     <h3>${d.name}</h3>
     <p><b>M√£:</b> ${d.code}</p>
     <p>${d.description}</p>
    </div>
   `);
  });
 });

function showDetail(id){
 db.collection("question_sets").doc(id).get().then(doc=>{
  currentSet={id,...doc.data()};
  listBox.style.display="none";
  detailBox.style.display="block";

  dName.innerText=currentSet.name;
  dCode.innerText=currentSet.code;
  dDesc.innerText=currentSet.description;
 });
}

function back(){
 detailBox.style.display="none";
 listBox.style.display="block";
}

function startExam(){
 localStorage.setItem("questionSetId",currentSet.id);
 localStorage.setItem("questionSetCode",currentSet.code);
 location.href="exam.html";
}
</script>

</body>
</html>
