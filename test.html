<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>CH·ªåN B·ªò ƒê·ªÄ THI</title>

<style>
body{
 margin:0;font-family:Arial,Helvetica,sans-serif;
 background:#eef2f6;
}
header{
 background:#1d3557;color:white;
 padding:22px;text-align:center;
 font-size:22px;font-weight:bold;
}
.container{
 max-width:1200px;margin:35px auto;
 padding:0 20px;
}
.section{
 margin-bottom:40px;
}
.section h2{
 color:#1d3557;margin-bottom:15px;
}
.grid{
 display:grid;
 grid-template-columns:repeat(auto-fit,minmax(300px,1fr));
 gap:25px;
}
.card{
 background:white;padding:22px;border-radius:14px;
 box-shadow:0 4px 15px rgba(0,0,0,.12);
 cursor:pointer;transition:.2s;
}
.card:hover{
 transform:translateY(-4px);
 box-shadow:0 6px 20px rgba(0,0,0,.18);
}
.card h3{margin-top:0;color:#1d3557;}
.card p{margin:6px 0;color:#555;font-size:15px;}

.detail{
 display:none;
 max-width:800px;margin:40px auto;
 background:white;padding:25px;border-radius:16px;
 box-shadow:0 6px 22px rgba(0,0,0,.18);
}
.detail h2{color:#1d3557;margin-top:0;}
.infoGrid{
 display:grid;
 grid-template-columns:1fr 1fr;
 gap:15px;margin-top:15px;
}
.infoBox{
 background:#f1f4fb;padding:14px;
 border-radius:10px;
}
.actions{
 margin-top:25px;
 display:flex;justify-content:center;gap:18px;
}
.btn{
 border:none;border-radius:12px;
 padding:15px 26px;font-size:16px;
 cursor:pointer;color:white;min-width:240px;
}
.btnStart{background:#2a9d8f;}
.btnBack{background:#457b9d;}
</style>
</head>

<body>

<header>H·ªÜ TH·ªêNG KI·ªÇM TRA LU·∫¨T GIAO TH√îNG</header>

<div class="container" id="mainBox">

 <!-- ===== KH·ªêI 1: A1 ===== -->
 <div class="section">
  <h2>üèçÔ∏è S√°t h·∫°ch l√°i xe m√¥ t√¥ qu√¢n s·ª±</h2>
  <div class="grid" id="a1Box"></div>
 </div>

 <!-- ===== KH·ªêI 2: √î T√î ===== -->
 <div class="section">
  <h2>üöõ Ki·ªÉm tra l√°i xe √¥ t√¥ qu√¢n s·ª±</h2>
  <div class="grid" id="carBox"></div>
 </div>

</div>

<!-- ===== CHI TI·∫æT B·ªò ƒê·ªÄ ===== -->
<div class="detail" id="detailBox">
 <h2 id="dName"></h2>
 <p id="dDesc"></p>

 <div class="infoGrid">
  <div class="infoBox">üìò <b>S·ªë c√¢u h·ªèi:</b> <span id="dCount"></span></div>
  <div class="infoBox">‚è±Ô∏è <b>Th·ªùi gian:</b> <span id="dTime"></span> ph√∫t</div>
  <div class="infoBox">‚úÖ <b>K·∫øt qu·∫£ ƒë·∫°t:</b> <span id="dPass"></span> c√¢u ƒë√∫ng</div>
  <div class="infoBox">üÜî <b>M√£ b·ªô ƒë·ªÅ:</b> <span id="dCode"></span></div>
 </div>

 <div class="actions">
  <button class="btn btnStart" onclick="startExam()">‚ñ∂ B·∫Øt ƒë·∫ßu l√†m b√†i</button>
  <button class="btn btnBack" onclick="back()">‚Ü© Quay l·∫°i</button>
 </div>
</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<script>
firebase.initializeApp({
 apiKey:"AIzaSyBGivIEsyBLsLs0CqRvwmwceG26duZbWlM",
 authDomain:"thi-luat-giao-thong.firebaseapp.com",
 projectId:"thi-luat-giao-thong"
});
const db=firebase.firestore();

let currentSet=null;

/* ===== LOAD A1 ===== */
db.collection("question_sets")
 .where("code","==","A1")
 .where("active","==",true)
 .get()
 .then(snap=>{
  snap.forEach(doc=>{
   const d=doc.data();
   a1Box.innerHTML+=`
    <div class="card" onclick="showDetail('${doc.id}')">
     <h3>${d.name}</h3>
     <p>${d.description}</p>
     <p><b>S·ªë c√¢u:</b> ${d.questionCount}</p>
     <p><b>Th·ªùi gian:</b> ${d.time} ph√∫t</p>
     <p><b>ƒê·∫°t:</b> ${d.passScore} c√¢u ƒë√∫ng</p>
    </div>
   `;
  });
 });

/* ===== LOAD √î T√î ===== */
db.collection("question_sets")
 .where("code","in",["CAR_150","CAR_450","CAR_600"])
 .where("active","==",true)
 .get()
 .then(snap=>{
  snap.forEach(doc=>{
   const d=doc.data();
   carBox.innerHTML+=`
    <div class="card" onclick="showDetail('${doc.id}')">
     <h3>${d.name}</h3>
     <p>${d.description}</p>
     <p><b>S·ªë c√¢u:</b> ${d.questionCount}</p>
     <p><b>Th·ªùi gian:</b> ${d.time} ph√∫t</p>
     <p><b>ƒê·∫°t:</b> ${d.passScore} c√¢u ƒë√∫ng</p>
    </div>
   `;
  });
 });

function showDetail(id){
 db.collection("question_sets").doc(id).get().then(doc=>{
  currentSet={id,...doc.data()};
  mainBox.style.display="none";
  detailBox.style.display="block";

  dName.innerText=currentSet.name;
  dDesc.innerText=currentSet.description;
  dCount.innerText=currentSet.questionCount;
  dTime.innerText=currentSet.time;
  dPass.innerText=currentSet.passScore;
  dCode.innerText=currentSet.code;
 });
}

function back(){
 detailBox.style.display="none";
 mainBox.style.display="block";
}

function startExam(){
 localStorage.setItem("questionSetId",currentSet.id);
 localStorage.setItem("questionSetCode",currentSet.code);
 location.href="exam.html";
}
</script>

</body>
</html>
